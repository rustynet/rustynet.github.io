Раскрытие защищенной информации в PDF

    Многим  из тех, кто активно работает с информацией, периодически попадаются
PDF-файлы  с  "заклеенными"  фрагментами  -  текстом,  таблицами и так далее. В
качестве примера можно привести образцы предложений с сайтов, торгующих разного
рода отчетами, исследованиями рынка и подобными данными.

    "Заклеивание"  фрагментов  PDF - защита очень ненадежная, и нередко громкие
утечки  связаны  с  этой или аналогично наивной техникой защиты. Взять например
случай  с  закрытым  отчетом  Пентагона  по инциденту с сотрудником итальянских
спецслужб  в  Ираке  -  в  данном  случае  было  достаточно выделить весь текст
документа       и      скопировать      его      в      текстовый      редактор
(http://www.theregister.co.uk/2005/05/03/military_report_secrets)  .  В  других
подобных  случаях  использовался редактор Adobe Acrobat Pro, с помощью которого
удаляли  "заклеивающие" полоски, представляющие собой векторные прямоугольники,
наложенные на текст. 

    Однако  вышеупомянутые  образцы  защищены чуть серьёзнее военных секретов -
PDF  файлы  содержат  также  защиту паролем от копирования или модификации, так
называемый  owner  password.  В  этом  случае не удастся ни скопировать скрытый
текст, ни удалить "заклеивание" из документа, не зная owner password.
  
    Тем  не  менее  существуют инструменты, позволяющие отредактировать и такой
файл,    не требующие установки громоздких коммерческих редакторов от Adobe или
Corel. Ближе к делу:
  
    Для    начала   нам   потребуется   бесплатная   программа   PDF   Unlocker
(http://smtguru.com;   на   момент   написания   статьи  на  сайте  проводились
технические  работы,  но  программа  доступна на множестве каталогов freeware).
Этот  инструмент,  фактически  -  набор  скриптов  для  GhostScript,  позволяет
отключить owner password,  а  помимо  этого работает с паролями на открытие PDF
(user  password)  и  конвертирует  EPS  в PNG. PDF Unlocker в считанные секунды
отключает  owner  password  и  сохраняет  копию  документа,  уже  готового  для
вивисекции.  Есть  небольшой нюанс - PDF Unlocker корректно сработал только при
помещении  защищенного  документа в один каталог с ярлычком "PDF unlocker, drop
PDF   files  here.lnk"  (по  умолчанию  это  рабочий  стол).  Ярлычок  ведет  к
unlockpdf.cmd   в   каталоге   программы,   но   помещение  документов  туда  и
запуск/редактирование   unlockpdf.cmd   не   помогли.   Мне   показалось  проще
переместить файлы.

    Собственно  вивисекция  проводится в любом редакторе PDF, но из соображений
минимализма   мой   выбор   остановился   на   shareware   Foxit   PDF  Editor.
(http://foxitsoftware.com/pdf/pe_intro.php).    При    маленьком    размере   и
нетребовательности  к  ресурсам  этот  редактор позволяет совершать большинство
операций  над  PDF  документами.  Всё,  что  требуется в случае "заклеивания" -
выделить  и  удалить  прямоугольники  или  надписи,  которые  закрывают  нужные
фрагменты документа, и сохранить файл.